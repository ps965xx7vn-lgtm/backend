{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load markdownify %}
{% load markdown_filters %}
{% load blog_extras %}

{% block title %}{{ article.title }} - {% trans "–ë–ª–æ–≥ PyLand" %}{% endblock %}
{% block description %}{{ meta_description }}{% endblock %}
{% if meta_keywords %}{% block keywords %}{{ meta_keywords }}{% endblock %}{% endif %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/courses/courses.css' %}">
<link rel="stylesheet" href="{% static 'css/blog/markdown.css' %}">
<link rel="stylesheet" href="{% static 'css/blog/article.css' %}">
<link rel="stylesheet" href="{% static 'css/blog/utils.css' %}">
<link rel="stylesheet" href="{% static 'css/blog/reactions.css' %}">
{% endblock %}

{% block content %}
<!-- Revolutionary Article Hero -->
<section class="revolutionary-hero-home">
    <div class="hero-particles">
        <div class="particle particle-1"></div>
        <div class="particle particle-2"></div>
        <div class="particle particle-3"></div>
        <div class="particle particle-4"></div>
        <div class="particle particle-5"></div>
    </div>
    
    <div class="container">
        <div class="hero-content-revolutionary">
            {% if article.category %}
            <div class="hero-category-revolutionary animate-fade-in">
                <span>{{ article.category.icon|default:"üìñ" }}</span>
                <span>{{ article.category.name }}</span>
            </div>
            {% endif %}
            
            <h1 class="hero-title-revolutionary animate-fade-in delay-1">
                {{ article.title }}
            </h1>
            
            {% if article.subtitle %}
            <p class="hero-subtitle-revolutionary animate-fade-in delay-2">
                {{ article.subtitle }}
            </p>
            {% endif %}
            
            <!-- Author Card Enhanced -->
            <a href="{% if article.blog_author %}{% url 'blog:author_detail' article.blog_author.slug %}{% else %}{% url 'blog:author_list' %}{% endif %}" class="hero-author-card-revolutionary animate-fade-in delay-3 author-card-clickable">
                <div class="author-main-info">
                    <div class="author-avatar-hero-large">
                        {{ article.author.username|safe_first|upper }}
                    </div>
                    <div class="author-details-hero">
                        <div class="author-name-hero-large">
                            {{ article.author.username }}
                            <span class="view-profile-arrow">‚Üí</span>
                        </div>
                        {% if article.blog_author and article.blog_author.bio %}
                        <div class="author-bio-hero">{{ article.blog_author.bio|truncatewords:20 }}</div>
                        {% else %}
                        <div class="author-bio-hero">{% trans "–≠–∫—Å–ø–µ—Ä—Ç –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º" %}</div>
                        {% endif %}
                        {% if article.blog_author %}
                        <div class="author-social-hero">
                            {% if article.blog_author.github_url %}
                            <a href="{{ article.blog_author.github_url }}" target="_blank" class="social-link-hero" title="GitHub" rel="noopener">
                                <span>üíª</span>
                            </a>
                            {% endif %}
                            {% if article.blog_author.linkedin_url %}
                            <a href="{{ article.blog_author.linkedin_url }}" target="_blank" class="social-link-hero" title="LinkedIn" rel="noopener">
                                <span>üíº</span>
                            </a>
                            {% endif %}
                            {% if article.blog_author.twitter_url %}
                            <a href="{{ article.blog_author.twitter_url }}" target="_blank" class="social-link-hero" title="Twitter" rel="noopener">
                                <span>üê¶</span>
                            </a>
                            {% endif %}
                        </div>
                        {% endif %}
                    </div>
                </div>
            </a>
            
            <!-- Meta Stats & Difficulty -->
            <div class="hero-meta-revolutionary animate-fade-in delay-4">
                <div class="meta-stats-hero-enhanced">
                    <div class="stat-card-hero">
                        <div class="stat-icon-hero stat-icon-date">
                            <span>üìÖ</span>
                        </div>
                        <div class="stat-content-hero">
                            <div class="stat-label-hero">{% trans "–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ" %}</div>
                            <div class="stat-value-hero">{{ article.published_at|date:"d.m.Y" }}</div>
                        </div>
                    </div>
                    
                    <div class="stat-card-hero">
                        <div class="stat-icon-hero stat-icon-time">
                            <span>‚è±Ô∏è</span>
                        </div>
                        <div class="stat-content-hero">
                            <div class="stat-label-hero">{% trans "–í—Ä–µ–º—è —á—Ç–µ–Ω–∏—è" %}</div>
                            <div class="stat-value-hero">{{ article.reading_time|default:"5" }} {% trans "–º–∏–Ω" %}</div>
                        </div>
                    </div>
                    
                    <div class="stat-card-hero">
                        <div class="stat-icon-hero stat-icon-views">
                            <span>üëÅÔ∏è</span>
                        </div>
                        <div class="stat-content-hero">
                            <div class="stat-label-hero">{% trans "–ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤" %}</div>
                            <div class="stat-value-hero">{{ article.views_count|default:"0" }}</div>
                        </div>
                    </div>
                    
                    {% if article.difficulty %}
                    <div class="stat-card-hero stat-card-difficulty difficulty-{{ article.difficulty }}">
                        <div class="stat-icon-hero">
                            {% if article.difficulty == 'beginner' %}
                                <span>üå±</span>
                            {% elif article.difficulty == 'intermediate' %}
                                <span>üåø</span>
                            {% elif article.difficulty == 'advanced' %}
                                <span>üå≥</span>
                            {% else %}
                                <span>ÔøΩ</span>
                            {% endif %}
                        </div>
                        <div class="stat-content-hero">
                            <div class="stat-label-hero">{% trans "–£—Ä–æ–≤–µ–Ω—å" %}</div>
                            <div class="stat-value-hero">
                                {% if article.difficulty == 'beginner' %}
                                    {% trans "–ù–∞—á–∞–ª—å–Ω—ã–π" %}
                                {% elif article.difficulty == 'intermediate' %}
                                    {% trans "–°—Ä–µ–¥–Ω–∏–π" %}
                                {% elif article.difficulty == 'advanced' %}
                                    {% trans "–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π" %}
                                {% else %}
                                    {% trans "–°—Ç–∞—Ç—å—è" %}
                                {% endif %}
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
            
            <!-- Tags Preview -->
            {% if article.tags.all %}
            <div class="hero-tags-revolutionary animate-fade-in delay-5">
                {% for tag in article.tags.all|slice:":5" %}
                <a href="{% url 'blog:tag_detail' tag.name %}" class="hero-tag-badge">#{{ tag.name }}</a>
                {% endfor %}
                {% if article.tags.count > 5 %}
                <span class="hero-tag-more">+{{ article.tags.count|add:"-5" }}</span>
                {% endif %}
            </div>
            {% endif %}
            
            <!-- Share Actions -->
            <div class="hero-share-revolutionary animate-fade-in delay-6">
                <span class="share-label">{% trans "–ü–æ–¥–µ–ª–∏—Ç—å—Å—è" %}:</span>
                <a href="https://twitter.com/intent/tweet?text={{ article.title|urlencode }}&url={{ request.build_absolute_uri }}" target="_blank" class="hero-share-btn" title="Twitter" rel="noopener">
                    <span>üê¶</span>
                </a>
                <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ request.build_absolute_uri|urlencode }}" target="_blank" class="hero-share-btn" title="LinkedIn" rel="noopener">
                    <span>üíº</span>
                </a>
                <a href="https://t.me/share/url?url={{ request.build_absolute_uri|urlencode }}&text={{ article.title|urlencode }}" target="_blank" class="hero-share-btn" title="Telegram" rel="noopener">
                    <span>‚úàÔ∏è</span>
                </a>
                <button class="hero-share-btn" title="{% trans '–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É' %}" data-copy-url="{{ request.build_absolute_uri }}">
                    <span>üîó</span>
                </button>
            </div>
        </div>
    </div>
</section>

<!-- Article Content Section -->
<section class="article-content-revolutionary">
    <div class="container">
        <div class="article-layout-revolutionary">
            <!-- Main Content -->
            <main class="article-main-revolutionary">
                {% if article.featured_image %}
                <div class="article-image-revolutionary animate-fade-in">
                    <img src="{{ article.featured_image.url }}" alt="{{ article.featured_image_alt|default:article.title }}" loading="lazy">
                </div>
                {% endif %}
                
                <div class="article-text-revolutionary markdown-content animate-fade-in delay-1">
                    {{ article.content|markdownify }}
                </div>
            </main>
            
            <!-- Revolutionary Sidebar -->
            <aside class="article-sidebar-revolutionary">
                <!-- Table of Contents -->
                <div class="sidebar-card-revolutionary animate-fade-in">
                    <div class="sidebar-card-header">
                        <span class="sidebar-icon">üìã</span>
                        <h3 class="sidebar-title-revolutionary">{% trans "–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ" %}</h3>
                    </div>
                    <div class="table-of-contents-revolutionary">
                        <a href="#introduction" class="toc-link">{% trans "–í–≤–µ–¥–µ–Ω–∏–µ" %}</a>
                        <a href="#main-content" class="toc-link">{% trans "–û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ" %}</a>
                        <a href="#examples" class="toc-link">{% trans "–ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞" %}</a>
                        <a href="#conclusion" class="toc-link">{% trans "–ó–∞–∫–ª—é—á–µ–Ω–∏–µ" %}</a>
                    </div>
                </div>
                
                <!-- Author Info -->
                <div class="sidebar-card-revolutionary animate-fade-in delay-1">
                    <div class="sidebar-card-header">
                        <span class="sidebar-icon">üë®‚Äçüíª</span>
                        <h3 class="sidebar-title-revolutionary">{% trans "–û–± –∞–≤—Ç–æ—Ä–µ" %}</h3>
                    </div>
                    <a href="{% if article.blog_author %}{% url 'blog:author_detail' article.blog_author.slug %}{% else %}{% url 'blog:author_list' %}{% endif %}" class="author-card-revolutionary author-card-clickable">
                        <div class="author-avatar-revolutionary">
                            {{ article.author.username|safe_first|upper }}
                        </div>
                        <div class="author-details-revolutionary">
                            <div class="author-name-revolutionary">
                                {{ article.author.username }}
                                <span class="view-profile-arrow-small">‚Üí</span>
                            </div>
                            <div class="author-role-revolutionary">{% trans "–≠–∫—Å–ø–µ—Ä—Ç –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é" %}</div>
                            <div class="author-stats-revolutionary">
                                <div class="stat">
                                    <span>üìù</span>
                                    <span>{{ article.author.articles.count|default:"5+" }} {% trans "—Å—Ç–∞—Ç–µ–π" %}</span>
                                </div>
                                <div class="stat">
                                    <span>‚≠ê</span>
                                    <span>4.8 {% trans "—Ä–µ–π—Ç–∏–Ω–≥" %}</span>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
                
                <!-- Related Articles -->
                <div class="sidebar-card-revolutionary animate-fade-in delay-2">
                    <div class="sidebar-card-header">
                        <span class="sidebar-icon">üìö</span>
                        <h3 class="sidebar-title-revolutionary">{% trans "–ß–∏—Ç–∞–π—Ç–µ —Ç–∞–∫–∂–µ" %}</h3>
                    </div>
                    <div class="related-articles-revolutionary">
                        {% for similar in similar_articles|slice:":3" %}
                        <a href="{{ similar.get_absolute_url }}" class="related-article-revolutionary">
                            <div class="related-article-meta">
                                <span class="related-category">{{ similar.category.icon|default:"üìñ" }}</span>
                                <span class="related-date">{{ similar.published_at|date:"d.m" }}</span>
                            </div>
                            <h4 class="related-title">{{ similar.title|truncatechars:50 }}</h4>
                        </a>
                        {% empty %}
                        <div class="related-article-revolutionary">
                            <p class="text-muted">{% trans "–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π" %}</p>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="sidebar-card-revolutionary animate-fade-in delay-3">
                    <div class="sidebar-card-header">
                        <span class="sidebar-icon">‚ö°</span>
                        <h3 class="sidebar-title-revolutionary">{% trans "–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è" %}</h3>
                    </div>
                        <div class="quick-actions-revolutionary" data-article-id="{{ article.pk }}" data-toggle-bookmark-url="{% url 'blog:toggle_bookmark' %}" data-report-url="{% url 'blog:report_article' %}">
                            <button type="button" class="action-btn-revolutionary print-action" data-action="print">
                                <span>üñ®Ô∏è</span>
                                <span>{% trans "–ü–µ—á–∞—Ç—å" %}</span>
                            </button>
                            <button type="button" class="action-btn-revolutionary bookmark-action" data-action="bookmark">
                                <span>üîñ</span>
                                <span>{% trans "–í –∑–∞–∫–ª–∞–¥–∫–∏" %}</span>
                            </button>
                            <button type="button" class="action-btn-revolutionary report-action" data-action="report">
                                <span>üö©</span>
                                <span>{% trans "–°–æ–æ–±—â–∏—Ç—å" %}</span>
                            </button>
                        </div>
                </div>
            </aside>
        </div>
    </div>
</section>

<!-- Article Reactions Section -->
<section class="reactions-section reactions-section-padded">
    <div class="container">
        <div class="article-reactions animate-fade-in" data-article-slug="{{ article.slug }}">
            <h3>{% trans "–í–∞—à–∞ —Ä–µ–∞–∫—Ü–∏—è –Ω–∞ —Å—Ç–∞—Ç—å—é" %}</h3>
            
            <div class="reaction-buttons">
                <button 
                    type="button" 
                    class="reaction-button" 
                    data-reaction-type="like"
                    aria-label="{% trans '–ù—Ä–∞–≤–∏—Ç—Å—è' %}"
                    title="{% trans '–ù—Ä–∞–≤–∏—Ç—Å—è' %}">
                    <span class="reaction-icon">üëç</span>
                    <span class="reaction-count" aria-live="polite"></span>
                    <span class="sr-only">{% trans "–ù—Ä–∞–≤–∏—Ç—Å—è" %}</span>
                </button>
                
                <button 
                    type="button" 
                    class="reaction-button" 
                    data-reaction-type="love"
                    aria-label="{% trans '–õ—é–±–æ–≤—å' %}"
                    title="{% trans '–õ—é–±–æ–≤—å' %}">
                    <span class="reaction-icon">‚ù§Ô∏è</span>
                    <span class="reaction-count" aria-live="polite"></span>
                    <span class="sr-only">{% trans "–õ—é–±–æ–≤—å" %}</span>
                </button>
                
                <button 
                    type="button" 
                    class="reaction-button" 
                    data-reaction-type="helpful"
                    aria-label="{% trans '–ü–æ–ª–µ–∑–Ω–æ' %}"
                    title="{% trans '–ü–æ–ª–µ–∑–Ω–æ' %}">
                    <span class="reaction-icon">üí°</span>
                    <span class="reaction-count" aria-live="polite"></span>
                    <span class="sr-only">{% trans "–ü–æ–ª–µ–∑–Ω–æ" %}</span>
                </button>
                
                <button 
                    type="button" 
                    class="reaction-button" 
                    data-reaction-type="insightful"
                    aria-label="{% trans '–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ' %}"
                    title="{% trans '–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ' %}">
                    <span class="reaction-icon">ü§î</span>
                    <span class="reaction-count" aria-live="polite"></span>
                    <span class="sr-only">{% trans "–ò–Ω—Ç–µ—Ä–µ—Å–Ω–æ" %}</span>
                </button>
                
                <button 
                    type="button" 
                    class="reaction-button" 
                    data-reaction-type="amazing"
                    aria-label="{% trans '–ü–æ—Ç—Ä—è—Å–∞—é—â–µ' %}"
                    title="{% trans '–ü–æ—Ç—Ä—è—Å–∞—é—â–µ' %}">
                    <span class="reaction-icon">ü§©</span>
                    <span class="reaction-count" aria-live="polite"></span>
                    <span class="sr-only">{% trans "–ü–æ—Ç—Ä—è—Å–∞—é—â–µ" %}</span>
                </button>
            </div>
        </div>
    </div>
</section>

<!-- Series Navigation (if article belongs to a series) -->
{% if current_series and series_count > 1 %}
<section class="series-navigation-revolutionary">
    <div class="container">
        <div class="series-nav-header animate-fade-in">
            <div class="series-pill">
                <span>üìö</span>
                <span class="series-pill-label">{% trans "–ß–∞—Å—Ç—å —Å–µ—Ä–∏–∏" %}</span>
            </div>
            <h2 class="series-title">
                <a href="{% url 'blog:series_detail' current_series.slug %}">
                    {{ current_series.title }}
                </a>
            </h2>
            <p class="series-desc">
                {{ current_series.description|truncatewords:20 }}
            </p>
        </div>
        
        <div class="series-navigation-grid">
            {% if series_prev_article %}
            <a href="{{ series_prev_article.get_absolute_url }}" class="series-nav-card series-prev animate-fade-in">
                <div class="series-nav-meta series-prev-meta">
                    <span class="series-arrow">‚Üê</span>
                    <span>{% trans "–ü—Ä–µ–¥—ã–¥—É—â–∞—è –≤ —Å–µ—Ä–∏–∏" %}</span>
                </div>
                <h3 class="series-card-title">{{ series_prev_article.title|truncatechars:50 }}</h3>
                <div class="series-card-footer">
                    <span>{{ series_prev_article.category.icon|default:"üìñ" }}</span>
                    <span>‚è± {{ series_prev_article.reading_time|default:"5" }} {% trans "–º–∏–Ω" %}</span>
                </div>
            </a>
            {% else %}
            <div class="series-nav-placeholder">{% trans "–ü–µ—Ä–≤–∞—è —Å—Ç–∞—Ç—å—è —Å–µ—Ä–∏–∏" %}</div>
            {% endif %}
            
            {% if series_next_article %}
            <a href="{{ series_next_article.get_absolute_url }}" class="series-nav-card series-next animate-fade-in delay-1">
                <div class="series-nav-meta series-next-meta">
                    <span>{% trans "–°–ª–µ–¥—É—é—â–∞—è –≤ —Å–µ—Ä–∏–∏" %}</span>
                    <span class="series-arrow">‚Üí</span>
                </div>
                <h3 class="series-card-title">{{ series_next_article.title|truncatechars:50 }}</h3>
                <div class="series-card-footer">
                    <span>{{ series_next_article.category.icon|default:"üìñ" }}</span>
                    <span>‚è± {{ series_next_article.reading_time|default:"5" }} {% trans "–º–∏–Ω" %}</span>
                </div>
            </a>
            {% else %}
            <div class="series-nav-placeholder">{% trans "–ü–æ—Å–ª–µ–¥–Ω—è—è —Å—Ç–∞—Ç—å—è —Å–µ—Ä–∏–∏" %} üéâ</div>
            {% endif %}
        </div>
        
        <div class="series-action">
            <a href="{% url 'blog:series_detail' current_series.slug %}" class="btn-revolutionary-hero btn-secondary-hero series-view-all">
                <span>üìö</span>
                <span>{% trans "–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ —Å—Ç–∞—Ç—å–∏ —Å–µ—Ä–∏–∏" %}</span>
            </a>
        </div>
    </div>
</section>

{% endif %}

<!-- Article Navigation -->
{% if prev_article or next_article %}
<section class="article-navigation-revolutionary">
    <div class="container">
        <div class="navigation-grid-revolutionary">
            {% if prev_article %}
            <a href="{{ prev_article.get_absolute_url }}" class="nav-card-revolutionary nav-prev animate-fade-in">
                <div class="nav-direction">
                    <span class="nav-arrow">‚Üê</span>
                    <span class="nav-label">{% trans "–ü—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç–∞—Ç—å—è" %}</span>
                </div>
                <h3 class="nav-title">{{ prev_article.title|truncatechars:60 }}</h3>
                <div class="nav-meta">
                    <span>{{ prev_article.category.icon|default:"üìñ" }}</span>
                    <span>{{ prev_article.published_at|date:"d.m.Y" }}</span>
                </div>
            </a>
            {% else %}
            <div class="nav-placeholder"></div>
            {% endif %}
            
            {% if next_article %}
            <a href="{{ next_article.get_absolute_url }}" class="nav-card-revolutionary nav-next animate-fade-in delay-1">
                <div class="nav-direction">
                    <span class="nav-label">{% trans "–°–ª–µ–¥—É—é—â–∞—è —Å—Ç–∞—Ç—å—è" %}</span>
                    <span class="nav-arrow">‚Üí</span>
                </div>
                <h3 class="nav-title">{{ next_article.title|truncatechars:60 }}</h3>
                <div class="nav-meta">
                    <span>{{ next_article.category.icon|default:"üìñ" }}</span>
                    <span>{{ next_article.published_at|date:"d.m.Y" }}</span>
                </div>
            </a>
            {% else %}
            <div class="nav-placeholder"></div>
            {% endif %}
        </div>
    </div>
</section>
{% endif %}

<!-- Comments Section -->
{% if article.allow_comments %}
<section class="comments-revolutionary" id="comments">
    <div class="container">
        <div class="comments-header-revolutionary animate-fade-in">
            <h2 class="comments-title-revolutionary">
                <span>üí¨</span>
                <span>{% trans "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏" %} ({{ comments_count|default:"0" }})</span>
            </h2>
        </div>
        
        {% if user.is_authenticated %}
        
        <form class="comment-form-revolutionary animate-fade-in delay-1" method="post" action="{{ article.get_absolute_url }}" id="mainCommentForm">
            {% csrf_token %}
            <div class="comment-author-revolutionary">
                <div class="comment-author-avatar">{{ user.username|safe_first|upper }}</div>
                <div class="comment-author-name">{{ user.username }}</div>
            </div>
            
            <textarea name="content" class="comment-textarea-revolutionary" placeholder="–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –≤–∞—à–∏–º–∏ –º—ã—Å–ª—è–º–∏ –æ —Å—Ç–∞—Ç—å–µ..." rows="4" maxlength="5000" id="id_content" required>{{ comment_form.content.value|default:'' }}</textarea>
            
            <div class="comment-actions-revolutionary">
                <button type="submit" class="comment-submit-revolutionary">
                    <span>‚úçÔ∏è</span>
                    <span>{% trans "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" %}</span>
                </button>
            </div>
        </form>
        {% else %}
        <div class="comment-auth-revolutionary animate-fade-in delay-1">
            <div class="auth-message">
                <span>üîê</span>
                <span>{% trans "–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" %}</span>
            </div>
            <a href="{% url 'authentication:signin' %}?next={{ request.path }}" class="auth-btn-revolutionary">
                <span>üö™</span>
                <span>{% trans "–í–æ–π—Ç–∏" %}</span>
            </a>
        </div>
        {% endif %}
        
        <!-- Comments List -->
        <div class="comments-list-revolutionary">
            {% for comment in comments %}
            <div class="comment-item-revolutionary animate-fade-in delay-{{ forloop.counter|add:1 }}" id="comment-{{ comment.id }}">
                <div class="comment-header-revolutionary">
                    <div class="comment-avatar-revolutionary">{{ comment.author.username|safe_first|upper }}</div>
                    <div class="comment-info-revolutionary">
                        <div class="comment-author-revolutionary">{{ comment.author.username }}</div>
                        <div class="comment-date-revolutionary">{{ comment.created_at|date:"d.m.Y –≤ H:i" }}</div>
                    </div>
                </div>
                <div class="comment-content-revolutionary" id="content-{{ comment.id }}">{{ comment.content|linebreaks }}</div>
                
                <!-- Edit Form (Hidden) -->
                <div id="edit-form-{{ comment.id }}" class="comment-edit-form-revolutionary hidden">
                    <form class="edit-form-revolutionary" method="post" action="{% url 'blog:comment_edit' comment.id %}">
                        {% csrf_token %}
                        <textarea name="content" class="comment-textarea-revolutionary" rows="4" maxlength="5000" required>{{ comment.content }}</textarea>
                        <div class="edit-form-actions">
                            <button type="submit" class="edit-submit-btn">
                                <span>‚úÖ</span>
                                <span>{% trans "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" %}</span>
                            </button>
                            <button type="button" class="edit-cancel-btn" data-comment-id="{{ comment.id }}" data-action="toggle-edit">
                                <span>‚ùå</span>
                                <span>{% trans "–û—Ç–º–µ–Ω–∞" %}</span>
                            </button>
                        </div>
                    </form>
                </div>
                
                <!-- Action Buttons -->
                {% if user.is_authenticated %}
                <div class="comment-actions-revolutionary">
                    <button class="reply-btn-revolutionary" data-comment-id="{{ comment.id }}" data-action="toggle-reply">
                        <span>‚Ü©Ô∏è</span>
                        <span>{% trans "–û—Ç–≤–µ—Ç–∏—Ç—å" %}</span>
                    </button>
                    {% if comment.author == user %}
                    <button class="edit-btn-revolutionary" data-comment-id="{{ comment.id }}" data-action="toggle-edit">
                        <span>‚úèÔ∏è</span>
                        <span>{% trans "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" %}</span>
                    </button>
                    <form method="post" action="{% url 'blog:comment_delete' comment.id %}" class="inline-form" data-confirm-delete="–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π?">
                        {% csrf_token %}
                        <button type="submit" class="delete-btn-revolutionary">
                            <span>üóëÔ∏è</span>
                            <span>{% trans "–£–¥–∞–ª–∏—Ç—å" %}</span>
                        </button>
                    </form>
                    {% endif %}
                </div>
                {% endif %}
                
                <!-- Reply Form (Hidden by default) -->
                {% if user.is_authenticated %}
                <div id="reply-form-{{ comment.id }}" class="comment-reply-form-revolutionary hidden">
                    <form class="reply-form-revolutionary" method="post" action="{{ article.get_absolute_url }}">
                        {% csrf_token %}
                        <input type="hidden" name="parent_id" value="{{ comment.id }}">
                        <div class="reply-form-header">
                            <div class="comment-author-avatar">{{ user.username|safe_first|upper }}</div>
                            <div class="reply-form-label">{% trans "–û—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" %} <strong>{{ comment.author.username }}</strong></div>
                        </div>
                        <textarea name="content" class="comment-textarea-revolutionary" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç..." rows="3" maxlength="5000" required></textarea>
                        <div class="reply-form-actions">
                            <button type="submit" class="reply-submit-btn">
                                <span>‚úçÔ∏è</span>
                                <span>{% trans "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç" %}</span>
                            </button>
                            <button type="button" class="reply-cancel-btn" data-comment-id="{{ comment.id }}" data-action="toggle-reply">
                                <span>‚ùå</span>
                                <span>{% trans "–û—Ç–º–µ–Ω–∞" %}</span>
                            </button>
                        </div>
                    </form>
                </div>
                {% endif %}
                
                <!-- Replies List -->
                {% if comment.replies.all %}
                <div class="comment-replies-revolutionary">
                    {% for reply in comment.replies.all %}
                    <div class="comment-reply-item-revolutionary" id="comment-{{ reply.id }}">
                        <div class="comment-header-revolutionary">
                            <div class="comment-avatar-revolutionary reply-avatar">{{ reply.author.username|safe_first|upper }}</div>
                            <div class="comment-info-revolutionary">
                                <div class="comment-author-revolutionary">{{ reply.author.username }}</div>
                                <div class="comment-date-revolutionary">{{ reply.created_at|date:"d.m.Y –≤ H:i" }}</div>
                            </div>
                        </div>
                        <div class="comment-content-revolutionary" id="content-{{ reply.id }}">{{ reply.content|linebreaks }}</div>
                        
                        <!-- Edit Form for Reply (Hidden) -->
                        <div id="edit-form-{{ reply.id }}" class="comment-edit-form-revolutionary hidden">
                            <form class="edit-form-revolutionary" method="post" action="{% url 'blog:comment_edit' reply.id %}">
                                {% csrf_token %}
                                <textarea name="content" class="comment-textarea-revolutionary" rows="3" maxlength="5000" required>{{ reply.content }}</textarea>
                                <div class="edit-form-actions">
                                    <button type="submit" class="edit-submit-btn">
                                        <span>‚úÖ</span>
                                        <span>{% trans "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" %}</span>
                                    </button>
                                    <button type="button" class="edit-cancel-btn" data-comment-id="{{ reply.id }}" data-action="toggle-edit">
                                        <span>‚ùå</span>
                                        <span>{% trans "–û—Ç–º–µ–Ω–∞" %}</span>
                                    </button>
                                </div>
                            </form>
                        </div>
                        
                        <!-- Action Buttons for Reply -->
                        {% if user.is_authenticated %}
                        <div class="comment-actions-revolutionary">
                            <button class="reply-btn-revolutionary reply-btn-nested" data-comment-id="{{ reply.id }}" data-action="toggle-reply">
                                <span>‚Ü©Ô∏è</span>
                                <span>{% trans "–û—Ç–≤–µ—Ç–∏—Ç—å" %}</span>
                            </button>
                            {% if reply.author == user %}
                            <button class="edit-btn-revolutionary edit-btn-nested" data-comment-id="{{ reply.id }}" data-action="toggle-edit">
                                <span>‚úèÔ∏è</span>
                                <span>{% trans "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å" %}</span>
                            </button>
                            <form method="post" action="{% url 'blog:comment_delete' reply.id %}" class="inline-form" data-confirm-delete="–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –æ—Ç–≤–µ—Ç?">
                                {% csrf_token %}
                                <button type="submit" class="delete-btn-revolutionary delete-btn-nested">
                                    <span>üóëÔ∏è</span>
                                    <span>{% trans "–£–¥–∞–ª–∏—Ç—å" %}</span>
                                </button>
                            </form>
                            {% endif %}
                        </div>
                        {% endif %}
                        
                        <!-- Reply to Reply Form -->
                        {% if user.is_authenticated %}
                        <div id="reply-form-{{ reply.id }}" class="comment-reply-form-revolutionary hidden">
                            <form class="reply-form-revolutionary" method="post" action="{{ article.get_absolute_url }}">
                                {% csrf_token %}
                                <input type="hidden" name="parent_id" value="{{ comment.id }}">
                                <div class="reply-form-header">
                                    <div class="comment-author-avatar">{{ user.username|safe_first|upper }}</div>
                                    <div class="reply-form-label">{% trans "–û—Ç–≤–µ—Ç –Ω–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π" %} <strong>{{ reply.author.username }}</strong></div>
                                </div>
                                <textarea name="content" class="comment-textarea-revolutionary" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç..." rows="3" maxlength="5000" required></textarea>
                                <div class="reply-form-actions">
                                    <button type="submit" class="reply-submit-btn">
                                        <span>‚úçÔ∏è</span>
                                        <span>{% trans "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç" %}</span>
                                    </button>
                                    <button type="button" class="reply-cancel-btn" data-comment-id="{{ reply.id }}" data-action="toggle-reply">
                                        <span>‚ùå</span>
                                        <span>{% trans "–û—Ç–º–µ–Ω–∞" %}</span>
                                    </button>
                                </div>
                            </form>
                        </div>
                        {% endif %}
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            {% empty %}
            <div class="empty-comments-revolutionary animate-fade-in delay-2">
                <div class="empty-icon">üí≠</div>
                <h3>{% trans "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ–∫–∞ –Ω–µ—Ç" %}</h3>
                <p>{% trans "–°—Ç–∞–Ω—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –ø–æ–¥–µ–ª–∏—Ç—Å—è –º–Ω–µ–Ω–∏–µ–º –æ–± —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ!" %}</p>
            </div>
            {% endfor %}
        </div>
        
        <!-- Pagination -->
        {% if comments.has_other_pages %}
        <div class="pagination-revolutionary">
            <div class="pagination-info">
                {% trans "–°—Ç—Ä–∞–Ω–∏—Ü–∞" %} {{ comments.number }} {% trans "–∏–∑" %} {{ comments.paginator.num_pages }}
            </div>
            <div class="pagination-buttons">
                {% if comments.has_previous %}
                <a href="?page=1#comments" class="pagination-btn pagination-first">
                    <span>‚èÆÔ∏è</span>
                    <span>{% trans "–ü–µ—Ä–≤–∞—è" %}</span>
                </a>
                <a href="?page={{ comments.previous_page_number }}#comments" class="pagination-btn pagination-prev">
                    <span>‚óÄÔ∏è</span>
                    <span>{% trans "–ü—Ä–µ–¥—ã–¥—É—â–∞—è" %}</span>
                </a>
                {% endif %}
                
                {% for num in comments.paginator.page_range %}
                    {% if comments.number == num %}
                        <span class="pagination-btn pagination-current">{{ num }}</span>
                    {% elif num > comments.number|add:'-3' and num < comments.number|add:'3' %}
                        <a href="?page={{ num }}#comments" class="pagination-btn">{{ num }}</a>
                    {% endif %}
                {% endfor %}
                
                {% if comments.has_next %}
                <a href="?page={{ comments.next_page_number }}#comments" class="pagination-btn pagination-next">
                    <span>{% trans "–°–ª–µ–¥—É—é—â–∞—è" %}</span>
                    <span>‚ñ∂Ô∏è</span>
                </a>
                <a href="?page={{ comments.paginator.num_pages }}#comments" class="pagination-btn pagination-last">
                    <span>{% trans "–ü–æ—Å–ª–µ–¥–Ω—è—è" %}</span>
                    <span>‚è≠Ô∏è</span>
                </a>
                {% endif %}
            </div>
        </div>
        {% endif %}
    </div>
</section>
{% endif %}

<!-- Similar Articles -->
<section class="features-revolutionary">
    <div class="container">
        <div class="section-header-revolutionary">
            <div class="section-badge animate-fade-in">
                <span>üîó</span>
                <span>{% trans "–ü–æ—Ö–æ–∂–∏–µ" %}</span>
            </div>
            <h2 class="section-title-revolutionary animate-fade-in delay-1">
                {% trans "–ü–æ—Ö–æ–∂–∏–µ —Å—Ç–∞—Ç—å–∏" %}
            </h2>
            <p class="section-subtitle-revolutionary animate-fade-in delay-2">
                {% trans "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ –∏–∑—É—á–µ–Ω–∏–µ —Å —ç—Ç–∏–º–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏" %}
            </p>
        </div>
        
        <div class="features-grid-revolutionary">
            {% if similar_articles %}
                {% for similar in similar_articles|slice:":3" %}
                <div class="feature-card-revolutionary animate-fade-in delay-{{ forloop.counter|add:1 }}">
                    <div class="feature-icon-revolutionary">
                        {{ similar.category.icon|default:"üìñ" }}
                    </div>
                    <h3 class="feature-title-revolutionary">
                        <a href="{{ similar.get_absolute_url }}">{{ similar.title|truncatechars:50 }}</a>
                    </h3>
                    <p class="feature-description-revolutionary">
                        {{ similar.excerpt|default:similar.content|smart_excerpt:15 }}
                    </p>
                    <div class="feature-stats-revolutionary">
                        <span class="stat">üìÖ {{ similar.published_at|date:"d.m.Y" }}</span>
                        <span class="stat">üëÅÔ∏è {{ similar.views_count|default:"0" }}</span>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <!-- –ü—Ä–∏–º–µ—Ä—ã –ø–æ—Ö–æ–∂–∏—Ö —Å—Ç–∞—Ç–µ–π -->
                <div class="feature-card-revolutionary animate-fade-in delay-2">
                    <div class="feature-icon-revolutionary">üêç</div>
                    <h3 class="feature-title-revolutionary">
                        <span>{% trans "–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π Python: –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã" %}</span>
                    </h3>
                    <p class="feature-description-revolutionary">
                        {% trans "–ò–∑—É—á–∞–µ–º –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç Python –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–ª–µ–≥–∞–Ω—Ç–Ω–æ–≥–æ –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ –∫–æ–¥–∞." %}
                    </p>
                    <div class="feature-stats-revolutionary">
                        <span class="stat">üìÖ 22.10.2025</span>
                        <span class="stat">üëÅÔ∏è 1.5K</span>
                    </div>
                </div>
                
                <div class="feature-card-revolutionary animate-fade-in delay-3">
                    <div class="feature-icon-revolutionary">‚öõÔ∏è</div>
                    <h3 class="feature-title-revolutionary">
                        <span>{% trans "React: –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏" %}</span>
                    </h3>
                    <p class="feature-description-revolutionary">
                        {% trans "–°–æ–≤–µ—Ç—ã –∏ —Ç–µ—Ö–Ω–∏–∫–∏ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±—ã—Å—Ç—Ä—ã—Ö React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π —Å –æ—Ç–ª–∏—á–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –æ–ø—ã—Ç–æ–º." %}
                    </p>
                    <div class="feature-stats-revolutionary">
                        <span class="stat">üìÖ 19.10.2025</span>
                        <span class="stat">üëÅÔ∏è 980</span>
                    </div>
                </div>
                
                <div class="feature-card-revolutionary animate-fade-in delay-4">
                    <div class="feature-icon-revolutionary">üîê</div>
                    <h3 class="feature-title-revolutionary">
                        <span>{% trans "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π: –æ—Å–Ω–æ–≤—ã" %}</span>
                    </h3>
                    <p class="feature-description-revolutionary">
                        {% trans "–ó–∞—â–∏—Ç–∏—Ç–µ –≤–∞—à–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∏ –∞—Ç–∞–∫ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–≤." %}
                    </p>
                    <div class="feature-stats-revolutionary">
                        <span class="stat">üìÖ 17.10.2025</span>
                        <span class="stat">üëÅÔ∏è 2.1K</span>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="cta-revolutionary">
    <div class="container">
        <div class="cta-content-revolutionary">
            <h2 class="cta-title-revolutionary animate-fade-in">
                {% trans "–ü–æ–Ω—Ä–∞–≤–∏–ª–∞—Å—å —Å—Ç–∞—Ç—å—è?" %}
            </h2>
            <p class="cta-description-revolutionary animate-fade-in delay-1">
                {% trans "–ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –Ω–∞—à–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –Ω–æ–≤—ã–µ —Å—Ç–∞—Ç—å–∏ –ø–µ—Ä–≤—ã–º–∏. –†–∞–∑–≤–∏–≤–∞–π—Ç–µ—Å—å –≤–º–µ—Å—Ç–µ —Å PyLand!" %}
            </p>
            <div class="cta-actions-revolutionary animate-fade-in delay-2">
                <a href="{% url 'blog:article_list' %}" class="btn-revolutionary-hero btn-primary-hero">
                    <span>üìö</span>
                    <span>{% trans "–í—Å–µ —Å—Ç–∞—Ç—å–∏" %}</span>
                </a>
                <a href="{% url 'core:contacts' %}" class="btn-revolutionary-hero btn-secondary-hero">
                    <span>üìß</span>
                    <span>{% trans "–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è" %}</span>
                </a>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
    // –ü–µ—Ä–µ–¥–∞–µ–º URL –∏–∑ Django –≤ JavaScript
    window.BLOG_CONFIG = {
        apiReactionUrl: "{% url 'blog:article_reaction' %}",
        apiCommentUrl: "{% url 'blog:add_comment' %}",
        csrfToken: "{{ csrf_token }}"
    };
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º Django messages —á–µ—Ä–µ–∑ showNotification
    {% if messages %}
    document.addEventListener('DOMContentLoaded', function() {
        {% for message in messages %}
        showNotification("{{ message|escapejs }}", "{{ message.tags }}");
        {% endfor %}
    });
    {% endif %}
</script>
<script src="{% static 'js/courses/courses.js' %}"></script>
<script src="{% static 'js/blog/code-copy.js' %}"></script>
<script src="{% static 'js/blog/article-detail.js' %}"></script>
<script src="{% static 'js/blog/article-reactions.js' %}"></script>
<script src="{% static 'js/blog/article-comments.js' %}"></script>
{% endblock %}