{% extends 'base.html' %}
{% load i18n static %}

{% block title %}{% trans "–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç" %} {{ certificate.certificate_number }} - Pyland{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/students/certificates-detail.css' %}">
{% endblock %}

{% block content %}
<div class="certificate-detail-page">
    <div class="container">
        <div class="certificate-container">
            <div class="certificate-banner">
                <div class="certificate-main-icon">üìú</div>
                <h1 class="certificate-main-title">{% trans "–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ–± –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –∫—É—Ä—Å–∞" %}</h1>
                <p class="certificate-subtitle">{{ certificate.course.name }}</p>
                <div class="certificate-number-large">{{ certificate.certificate_number }}</div>
            </div>

            <div class="certificate-content">
                <div class="status-section">
                    {% if certificate.is_valid %}
                        <span class="status-badge-large status-valid-large">
                            ‚úì {% trans "–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω" %}
                        </span>
                        <p class="status-valid-text">
                            {% trans "–í—ã–¥–∞–Ω" %} {{ certificate.completion_date|date:"d F Y –≥." }}
                        </p>
                    {% else %}
                        <span class="status-badge-large status-revoked-large">
                            ‚úó {% trans "–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç–æ–∑–≤–∞–Ω" %}
                        </span>
                        {% if certificate.revoke_reason %}
                        <p class="status-revoked-text">
                            <strong>{% trans "–ü—Ä–∏—á–∏–Ω–∞:" %}</strong> {{ certificate.revoke_reason }}
                        </p>
                        {% endif %}
                    {% endif %}
                </div>

                <div class="info-grid">
                    <div class="info-card">
                        <div class="info-label">üë§ {% trans "–°—Ç—É–¥–µ–Ω—Ç" %}</div>
                        <div class="info-value">{{ certificate.student.user.get_full_name|default:certificate.student.user.email }}</div>
                    </div>

                    <div class="info-card">
                        <div class="info-label">üìö {% trans "–ö—É—Ä—Å" %}</div>
                        <div class="info-value">{{ certificate.course.name }}</div>
                    </div>

                    <div class="info-card">
                        <div class="info-label">üìÖ {% trans "–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è" %}</div>
                        <div class="info-value">{{ certificate.completion_date|date:"d.m.Y" }}</div>
                    </div>

                    <div class="info-card">
                        <div class="info-label">üîê {% trans "–ö–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏" %}</div>
                        <div class="info-value info-value-code">
                            {{ certificate.verification_code }}
                        </div>
                    </div>
                </div>

                <div class="stats-section">
                    <h3>üìä {% trans "–ü–æ–¥—Ä–æ–±–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è" %}</h3>
                    <div class="stats-detailed">
                        <div class="stat-box">
                            <div class="stat-box-icon">üìñ</div>
                            <div class="stat-box-value">{{ certificate.lessons_completed }}/{{ certificate.total_lessons }}</div>
                            <div class="stat-box-label">{% trans "–ó–∞–≤–µ—Ä—à–µ–Ω–æ —É—Ä–æ–∫–æ–≤" %}</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-box-icon">üìù</div>
                            <div class="stat-box-value">{{ certificate.assignments_submitted }}</div>
                            <div class="stat-box-label">{% trans "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∑–∞–¥–∞–Ω–∏–π" %}</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-box-icon">‚úÖ</div>
                            <div class="stat-box-value">{{ certificate.assignments_approved }}</div>
                            <div class="stat-box-label">{% trans "–û–¥–æ–±—Ä–µ–Ω–æ –∑–∞–¥–∞–Ω–∏–π" %}</div>
                        </div>

                        <div class="stat-box">
                            <div class="stat-box-icon">üí¨</div>
                            <div class="stat-box-value">{{ certificate.reviews_received }}</div>
                            <div class="stat-box-label">{% trans "–ü–æ–ª—É—á–µ–Ω–æ –æ—Ç–∑—ã–≤–æ–≤" %}</div>
                        </div>

                        {% if certificate.total_time_spent %}
                        <div class="stat-box">
                            <div class="stat-box-icon">‚è±Ô∏è</div>
                            <div class="stat-box-value">{{ certificate.total_time_spent|floatformat:1 }}</div>
                            <div class="stat-box-label">{% trans "–ß–∞—Å–æ–≤ –æ–±—É—á–µ–Ω–∏—è" %}</div>
                        </div>
                        {% endif %}

                        {% if certificate.final_grade %}
                        <div class="stat-box">
                            <div class="stat-box-icon">üéØ</div>
                            <div class="stat-box-value">{{ certificate.final_grade }}%</div>
                            <div class="stat-box-label">{% trans "–ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞" %}</div>
                        </div>
                        {% endif %}
                    </div>
                </div>

                <div class="action-buttons">
                    {% if certificate.pdf_file %}
                    <a href="{% url 'certificates:download' certificate.verification_code %}" class="btn-action btn-success-action">
                        <span>‚¨áÔ∏è</span>
                        <span>{% trans "–°–∫–∞—á–∞—Ç—å PDF" %}</span>
                    </a>
                    {% else %}
                    <a href="{% url 'certificates:download' certificate.verification_code %}" class="btn-action btn-success-action">
                        <span>üìÑ</span>
                        <span>{% trans "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å PDF" %}</span>
                    </a>
                    {% endif %}

                    <a href="{% url 'certificates:verify' certificate.verification_code %}"
                       class="btn-action btn-primary-action" target="_blank">
                        <span>üîç</span>
                        <span>{% trans "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å" %}</span>
                    </a>

                    <a href="{% url 'certificates:list' %}" class="btn-action btn-secondary-action">
                        <span>‚óÄÔ∏è</span>
                        <span>{% trans "–í—Å–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã" %}</span>
                    </a>
                </div>

                <div class="verification-info">
                    <h4>üîê {% trans "–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞" %}</h4>
                    <p>{% trans "–†–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ª–∏–Ω–Ω–æ—Å—Ç—å —ç—Ç–æ–≥–æ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ–¥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–ª–∏ –Ω–æ–º–µ—Ä —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –Ω–∞ –ø—É–±–ª–∏—á–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ." %}</p>
                    <div class="verification-code">{{ certificate.verification_code }}</div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
