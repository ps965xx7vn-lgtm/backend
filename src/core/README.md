# Core Application

–ë–∞–∑–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Pyland –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏
—Å–∞–π—Ç–∞, –ø—É–±–ª–∏—á–Ω—ã–º–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏ –∏ REST API.

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **[Templates README](templates/README.md)** - HTML —à–∞–±–ª–æ–Ω—ã –∏ –∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **[Template Tags README](templatetags/README.md)** - Custom template tags –∏ —Ñ–∏–ª—å—Ç—Ä—ã
- **[Tests README](tests/README.md)** - –Æ–Ω–∏—Ç —Ç–µ—Å—Ç—ã –∏ coverage (53 —Ç–µ—Å—Ç–∞)

## üéØ –û–±–∑–æ—Ä

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ `core` - —ç—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Pyland —Å –±–∞–∑–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é:

- **–ü—É–±–ª–∏—á–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã**: –ì–ª–∞–≤–Ω–∞—è, –ö–æ–Ω—Ç–∞–∫—Ç—ã, –û –Ω–∞—Å, –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- **–§–æ—Ä–º—ã**: –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å, –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É
- **REST API**: 4 –ø—É–±–ª–∏—á–Ω—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ (Django Ninja)
- **Context Processors**: –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ñ—É—Ç–µ—Ä–∞
- **Template Tags**: Markdown —Ñ–∏–ª—å—Ç—Ä—ã, article tags
- **–†–æ–ª—å-based —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã**: –£–º–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –ø–æ–ø—É–ª—è—Ä–Ω—ã–º–∏ –∫—É—Ä—Å–∞–º–∏
‚úÖ –§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
‚úÖ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ email —Ä–∞—Å—Å—ã–ª–∫—É
‚úÖ –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (Terms of Service, Privacy Policy)
‚úÖ REST API –¥–ª—è AJAX –∑–∞–ø—Ä–æ—Å–æ–≤
‚úÖ Context processor –¥–ª—è —Ñ—É—Ç–µ—Ä–∞ —Å–∞–π—Ç–∞
‚úÖ Markdown –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ —à–∞–±–ª–æ–Ω–∞—Ö
‚úÖ –£–º–Ω—ã–µ —Ä–µ–¥–∏—Ä–µ–∫—Ç—ã –ø–æ —Ä–æ–ª—è–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚úÖ 53 —é–Ω–∏—Ç —Ç–µ—Å—Ç–∞ (–ø–æ–∫—Ä—ã—Ç–∏–µ API –∏ —Å—Ö–µ–º)
‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π (logger)

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```text
core/
‚îú‚îÄ‚îÄ __init__.py              # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º docstring
‚îú‚îÄ‚îÄ apps.py                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (CoreConfig)
‚îú‚îÄ‚îÄ api.py                   # REST API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã (4 endpoints) + logger + try-except
‚îú‚îÄ‚îÄ schemas.py               # Pydantic —Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (6 —Å—Ö–µ–º)
‚îú‚îÄ‚îÄ forms.py                 # Django —Ñ–æ—Ä–º—ã (FeedbackForm, SubscriptionForm) + logger
‚îú‚îÄ‚îÄ views.py                 # Django –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (7 views) + logger + try-except
‚îú‚îÄ‚îÄ urls.py                  # URL –º–∞—Ä—à—Ä—É—Ç—ã (6 URL patterns)
‚îú‚îÄ‚îÄ context_processors.py    # –ì–ª–æ–±–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –¥–ª—è —à–∞–±–ª–æ–Ω–æ–≤
‚îú‚îÄ‚îÄ cache_utils.py           # ‚≠ê –£—Ç–∏–ª–∏—Ç—ã –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è (Redis) + logger
‚îú‚îÄ‚îÄ middleware.py            # ‚≠ê Rate limiting –∏ security headers + logger
‚îú‚îÄ‚îÄ migrations/              # –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–Ω–µ—Ç —Å–≤–æ–∏—Ö –º–æ–¥–µ–ª–µ–π)
‚îú‚îÄ‚îÄ templates/               # HTML —à–∞–±–ª–æ–Ω—ã
‚îÇ   ‚îú‚îÄ‚îÄ README.md           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ core/
‚îÇ       ‚îú‚îÄ‚îÄ home.html        # –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îÇ       ‚îú‚îÄ‚îÄ contacts.html    # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
‚îÇ       ‚îú‚îÄ‚îÄ about.html       # –û –Ω–∞—Å
‚îÇ       ‚îú‚îÄ‚îÄ terms_of_service.html    # –£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îÇ       ‚îî‚îÄ‚îÄ privacy_policy.html      # –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ templatetags/            # Custom template tags
‚îÇ   ‚îú‚îÄ‚îÄ README.md           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è template tags
‚îÇ   ‚îú‚îÄ‚îÄ markdown_filters.py  # –§–∏–ª—å—Ç—Ä—ã –¥–ª—è Markdown
‚îÇ   ‚îî‚îÄ‚îÄ article_tags.py      # –¢–µ–≥–∏ –¥–ª—è —Å—Ç–∞—Ç–µ–π –±–ª–æ–≥–∞
‚îî‚îÄ‚îÄ tests/                   # –Æ–Ω–∏—Ç —Ç–µ—Å—Ç—ã (53 —Ç–µ—Å—Ç–∞)
    ‚îú‚îÄ‚îÄ README.md            # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
    ‚îú‚îÄ‚îÄ test_api.py          # –¢–µ—Å—Ç—ã API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤ (15 —Ç–µ—Å—Ç–æ–≤)
    ‚îú‚îÄ‚îÄ test_schemas.py      # –¢–µ—Å—Ç—ã Pydantic —Å—Ö–µ–º (28 —Ç–µ—Å—Ç–æ–≤)
    ‚îî‚îÄ‚îÄ test_response_validation.py  # –í–∞–ª–∏–¥–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ (10 —Ç–µ—Å—Ç–æ–≤)
```text
**‚≠ê –ù–æ–≤—ã–µ –º–æ–¥—É–ª–∏ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ blog):**

- `cache_utils.py` - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü –∏ API –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Redis
- `middleware.py` - Rate limiting –¥–ª—è API + security headers

**–°–º. –ø–æ–¥—Ä–æ–±–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é:**

- [Templates README](templates/README.md) - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —à–∞–±–ª–æ–Ω–æ–≤
- [Template Tags README](templatetags/README.md) - Custom template tags
- [Tests README](tests/README.md) - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤

**–ú–æ–¥—É–ª–∏ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º:**

- `views.py` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –∏ –ø–æ–¥–ø–∏—Å–æ–∫ + –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- `api.py` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ API –∑–∞–ø—Ä–æ—Å–æ–≤ (feedback, subscription) + –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π
- `forms.py` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º
- `cache_utils.py` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π –∫–µ—à–∞ (HIT/MISS, –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è)
- `middleware.py` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ rate limit –ø—Ä–µ–≤—ã—à–µ–Ω–∏–π –∏ –æ—à–∏–±–æ–∫

## üîå API —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### –ë–∞–∑–æ–≤—ã–π URL

```text
/api/core/
```text
–í—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –ø—É–±–ª–∏—á–Ω—ã–µ (–Ω–µ —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏).

### 1. –û—Ç–ø—Ä–∞–≤–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏

**POST** `/api/core/feedback/`

–°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –∑–∞—è–≤–∫—É –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**Request Body:**

```json
{
  "first_name": "–ò–≤–∞–Ω",
  "phone_number": "+79991234567",
  "email": "ivan@example.com",
  "message": "–•–æ—á—É —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ –∫—É—Ä—Å–∞—Ö Python",
  "agree_terms": true
}
```text
**Validation:**

- `first_name`: –Ω–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ü–∏—Ñ—Ä—ã
- `phone_number`: —Ñ–æ—Ä–º–∞—Ç `+XXXXXXXXX` (9-15 —Ü–∏—Ñ—Ä –ø–æ—Å–ª–µ +)
- `email`: –≤–∞–ª–∏–¥–Ω—ã–π email –∞–¥—Ä–µ—Å
- `message`: –º–∏–Ω–∏–º—É–º 10 —Å–∏–º–≤–æ–ª–æ–≤
- `agree_terms`: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `true`

**Response 200:**

```json
{
  "success": true,
  "message": "–°–ø–∞—Å–∏–±–æ! –ú—ã –ø–æ–ª—É—á–∏–ª–∏ –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.",
  "feedback_id": 42
}
```text
---

### 2. –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É

**POST** `/api/core/subscribe/`

–ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç email –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É –Ω–æ–≤–æ—Å—Ç–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.

**Request Body:**

```json
{
  "email": "user@example.com"
}
```text
**Response 200 (–Ω–æ–≤–∞—è –ø–æ–¥–ø–∏—Å–∫–∞):**

```json
{
  "success": true,
  "message": "–í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É!",
  "already_subscribed": false
}
```text
**Response 200 (—É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω):**

```json
{
  "success": true,
  "message": "–≠—Ç–æ—Ç email —É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É.",
  "already_subscribed": true
}
```text
**Response 200 (—Ä–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è):**

```json
{
  "success": true,
  "message": "–í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞ —Å–Ω–æ–≤–∞ –∞–∫—Ç–∏–≤–Ω–∞!",
  "already_subscribed": false
}
```text
---

### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

**GET** `/api/core/contact-info/`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ç–∞–∫—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∫–æ–º–ø–∞–Ω–∏–∏.

**Response 200:**

```json
{
  "email": "pylandschool@gmail.com",
  "phone": "+7 (999) 123-45-67",
  "address": "–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 1",
  "working_hours": "–ü–Ω-–ü—Ç: 9:00-18:00",
  "social_links": {
    "telegram": "<https://t.me/pyland",>
    "vk": "<https://vk.com/pyland",>
    "youtube": "<https://youtube.com/@pyland">
  }
}
```text
---

### 4. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

**GET** `/api/core/stats/`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.

**Response 200:**

```json
{
  "total_students": 1250,
  "total_courses": 15,
  "total_lessons": 342,
  "completion_rate": 78.5
}
```text
---

## üìÑ –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (Views)

### Function-Based Views

–í—Å–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã.

#### `home(request)`

–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.

**–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç:**

- –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫—É—Ä—Å—ã (–∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å—Ç—É–¥–µ–Ω—Ç–æ–≤)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- SEO –º–µ—Ç–∞-—Ç–µ–≥–∏

**URL:** `/`
**Template:** `core/home.html`

---

#### `contacts(request)`

–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ —Å —Ñ–æ—Ä–º–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏.

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã `FeedbackForm`
- –û–±—Ä–∞–±–æ—Ç–∫–∞ POST –∑–∞–ø—Ä–æ—Å–æ–≤
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞—è–≤–æ–∫ –≤ –º–æ–¥–µ–ª—å `Feedback` (–∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è `manager`)
- Flash messages –æ–± —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–∞—Ö

**URL:** `/contacts/`
**Template:** `core/contacts.html`

---

#### `about(request)`

–°—Ç—Ä–∞–Ω–∏—Ü–∞ "–û –Ω–∞—Å" —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ.

**URL:** `/about/`
**Template:** `core/about.html`

---

#### `subscribe(request)`

–û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ email —Ä–∞—Å—Å—ã–ª–∫—É.

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

- –í–∞–ª–∏–¥–∞—Ü–∏—è email —á–µ—Ä–µ–∑ `SubscriptionForm`
- –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –º–æ–¥–µ–ª—å `Subscription` (notifications app)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ø–æ–¥–ø–∏—Å–æ–∫
- –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å flash message

**URL:** `/subscribe/` (POST)
**Redirect:** `/`

---

#### `terms_of_service(request)`

–°—Ç—Ä–∞–Ω–∏—Ü–∞ —É—Å–ª–æ–≤–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (—é—Ä–∏–¥–∏—á–µ—Å–∫–∞—è).

**URL:** `/terms-of-service/`
**Template:** `core/terms_of_service.html`

---

#### `privacy_policy(request)`

–°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ (—é—Ä–∏–¥–∏—á–µ—Å–∫–∞—è).

**URL:** `/privacy-policy/`
**Template:** `core/privacy_policy.html`

---

#### `home_redirect(request)`

–£–º–Ω—ã–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ –∏—Ö —Ä–æ–ª—è–º.

**–õ–æ–≥–∏–∫–∞ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏:**

- **–ù–µ–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ** ‚Üí –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (`core:home`)
- **Mentor** ‚Üí `mentor:mentor_dashboard`
- **Student** ‚Üí `account:account_dashboard`
- **Manager** ‚Üí `manager:manager_dashboard`
- **Reviewer** ‚Üí `reviewer:reviewer_dashboard`
- **–ë–µ–∑ —Ä–æ–ª–µ–π** ‚Üí –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞

**URL:** `/` (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∫–∞–∫ root redirect)

---

## üìù –§–æ—Ä–º—ã

### FeedbackForm

–§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –∏ –≥–ª–∞–≤–Ω–æ–π.

**–ü–æ–ª—è:**

- `first_name` - –ò–º—è –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è (–º–∞–∫—Å 100 —Å–∏–º–≤–æ–ª–æ–≤)
- `phone_number` - –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (+1234567890)
- `email` - Email –∞–¥—Ä–µ—Å
- `message` - –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ, textarea)
- `agree_terms` - –°–æ–≥–ª–∞—Å–∏–µ —Å —É—Å–ª–æ–≤–∏—è–º–∏ (checkbox)

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**

- –ò–º—è –Ω–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ü–∏—Ñ—Ä—ã
- –¢–µ–ª–µ—Ñ–æ–Ω –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `+` –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å 9-15 —Ü–∏—Ñ—Ä
- Email –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–æ–≥–ª–∞—Å–∏–µ —Å —É—Å–ª–æ–≤–∏—è–º–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```python
form = FeedbackForm(request.POST)
if form.is_valid():
    name = form.cleaned_data['first_name']
    Feedback.objects.create(**form.cleaned_data)
```text
---

### SubscriptionForm

–§–æ—Ä–º–∞ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ email —Ä–∞—Å—Å—ã–ª–∫—É.

**–ü–æ–ª—è:**

- `email` - Email –∞–¥—Ä–µ—Å –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**

- Email –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∞–ª–∏–¥–Ω—ã–º

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```python
form = SubscriptionForm(request.POST)
if form.is_valid():
    email = form.cleaned_data['email']
    Subscription.objects.get_or_create(email=email)
```text
---

## üîç –°—Ö–µ–º—ã (Pydantic)

### Input Schemas

#### FeedbackSchema

–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏.

```python
class FeedbackSchema(Schema):
    first_name: str = Field(..., min_length=1, max_length=100)
    phone_number: str = Field(..., pattern=r'^\+\d{9,15}$')
    email: EmailStr
    message: str = Field(..., min_length=10)
    agree_terms: bool = Field(..., const=True)

    @field_validator('first_name')
    @classmethod
    def validate_no_digits(cls, value: str) -> str:
        if any(char.isdigit() for char in value):
            raise ValueError("–ò–º—è –Ω–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ü–∏—Ñ—Ä—ã")
        return value
```text
---

#### SubscriptionSchema

–í–∞–ª–∏–¥–∞—Ü–∏—è email –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏.

```python
class SubscriptionSchema(Schema):
    email: EmailStr
```text
---

### Output Schemas

#### FeedbackResponseSchema

–û—Ç–≤–µ—Ç –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞—è–≤–∫–∏ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏.

```python
class FeedbackResponseSchema(Schema):
    success: bool
    message: str
    feedback_id: int
```text
---

#### SubscriptionResponseSchema

–û—Ç–≤–µ—Ç –ø–æ—Å–ª–µ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É.

```python
class SubscriptionResponseSchema(Schema):
    success: bool
    message: str
    already_subscribed: bool
```text
---

#### ContactInfoSchema

–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∫–æ–º–ø–∞–Ω–∏–∏.

```python
class ContactInfoSchema(Schema):
    email: str
    phone: str
    address: Optional[str] = None
    working_hours: Optional[str] = None
    social_links: Optional[Dict[str, str]] = None
```text
---

#### StatsSchema

–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã.

```python
class StatsSchema(Schema):
    total_students: int = Field(default=0, ge=0)
    total_courses: int = Field(default=0, ge=0)
    total_lessons: int = Field(default=0, ge=0)
    completion_rate: float = Field(default=0.0, ge=0.0, le=100.0)
```text
---

## üåê Context Processors

### footer_data(request)

–î–æ–±–∞–≤–ª—è–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—Å–µ—Ö —à–∞–±–ª–æ–Ω–æ–≤.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**

```python
{
    'footer_data': {
        'popular_courses': QuerySet[Course],  # 3 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –∫—É—Ä—Å–∞
        'stats': {
            'total_students': int,
            'total_courses': int,
            'total_lessons': int,
            'completion_rate': float
        }
    }
}
```text
**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —à–∞–±–ª–æ–Ω–µ:**

```django
{% for course in footer_data.popular_courses %}
    <a href="{{ course.get_absolute_url }}">{{ course.title }}</a>
{% endfor %}

<p>–°—Ç—É–¥–µ–Ω—Ç–æ–≤: {{ footer_data.stats.total_students }}</p>
```text
**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ settings.py:**

```python
TEMPLATES = [
    {
        'OPTIONS': {
            'context_processors': [

                #

                'core.context_processors.footer_data',
            ],
        },
    },
]
```text
---

## üè∑Ô∏è Template Tags

### Markdown Filters

**–§–∞–π–ª:** `templatetags/markdown_filters.py`

#### `markdown_format`

–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç Markdown —Ç–µ–∫—Å—Ç –≤ HTML.

```django
{% load markdown_filters %}

{{ article.content|markdown_format|safe }}
```text
#### `get_item`

–ü–æ–ª—É—á–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –∏–∑ —Å–ª–æ–≤–∞—Ä—è –ø–æ –∫–ª—é—á—É.

```django
{{ my_dict|get_item:"key_name" }}
```text
#### `clean_markdown`

–£–¥–∞–ª—è–µ—Ç Markdown —Ä–∞–∑–º–µ—Ç–∫—É, –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ —Ç–µ–∫—Å—Ç.

```django
{{ article.content|clean_markdown }}
```text
#### `smart_excerpt`

–°–æ–∑–¥–∞–µ—Ç —É–º–Ω—É—é –≤—ã–¥–µ—Ä–∂–∫—É –∏–∑ —Ç–µ–∫—Å—Ç–∞ (–ø–µ—Ä–≤—ã–µ 150 —Å–∏–º–≤–æ–ª–æ–≤).

```django
{{ article.content|smart_excerpt:150 }}
```text
---

### Article Tags

**–§–∞–π–ª:** `templatetags/article_tags.py`

#### `pluralize_articles`

–°–∫–ª–æ–Ω–µ–Ω–∏–µ —Å–ª–æ–≤–∞ "—Å—Ç–∞—Ç—å—è" –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞.

```django
{% load article_tags %}

{{ count }} {{ count|pluralize_articles }}

<!-- –í—ã–≤–æ–¥:
1 —Å—Ç–∞—Ç—å—è
2 —Å—Ç–∞—Ç—å–∏
5 —Å—Ç–∞—Ç–µ–π
-->
```text
---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

```text
tests/
‚îú‚îÄ‚îÄ test_api.py                     # 15 —Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ test_schemas.py                 # 28 —Ç–µ—Å—Ç–æ–≤
‚îî‚îÄ‚îÄ test_response_validation.py     # 10 —Ç–µ—Å—Ç–æ–≤
```text
**–í—Å–µ–≥–æ: 53 —Ç–µ—Å—Ç–∞** ‚úÖ

---

### test_api.py (15 —Ç–µ—Å—Ç–æ–≤)

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤:

**Feedback API (6 —Ç–µ—Å—Ç–æ–≤):**

- ‚úÖ `test_create_feedback_success` - —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏
- ‚úÖ `test_create_feedback_invalid_phone` - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- ‚úÖ `test_create_feedback_invalid_email` - –≤–∞–ª–∏–¥–∞—Ü–∏—è email
- ‚úÖ `test_create_feedback_short_message` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã
- ‚úÖ `test_create_feedback_without_consent` - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–≥–ª–∞—Å–∏—è
- ‚úÖ `test_create_feedback_name_with_digits` - –∏–º—è –±–µ–∑ —Ü–∏—Ñ—Ä

**Subscription API (4 —Ç–µ—Å—Ç–∞):**

- ‚úÖ `test_create_subscription_new` - –Ω–æ–≤–∞—è –ø–æ–¥–ø–∏—Å–∫–∞
- ‚úÖ `test_create_subscription_already_exists` - –¥—É–±–ª–∏–∫–∞—Ç –ø–æ–¥–ø–∏—Å–∫–∏
- ‚úÖ `test_reactivate_inactive_subscription` - —Ä–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è
- ‚úÖ `test_subscription_invalid_email` - –≤–∞–ª–∏–¥–∞—Ü–∏—è email

**Contact Info API (1 —Ç–µ—Å—Ç):**

- ‚úÖ `test_get_contact_info` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤

**Stats API (3 —Ç–µ—Å—Ç–∞):**

- ‚úÖ `test_get_stats_empty_db` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—É—Å—Ç–æ–π –ë–î
- ‚úÖ `test_get_stats_with_data` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å –¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ `test_stats_counts_all_courses` - –ø–æ–¥—Å—á–µ—Ç –∫—É—Ä—Å–æ–≤

**Integration (1 —Ç–µ—Å—Ç):**

- ‚úÖ `test_full_user_journey` - –ø–æ–ª–Ω—ã–π –ø—É—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### test_schemas.py (28 —Ç–µ—Å—Ç–æ–≤)

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Pydantic —Å—Ö–µ–º:

**FeedbackSchema (10 —Ç–µ—Å—Ç–æ–≤):**

- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–∞–ª–∏–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω –±–µ–∑ `+`
- ‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω —Å –Ω–µ–≤–µ—Ä–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º
- ‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π/–¥–ª–∏–Ω–Ω—ã–π
- ‚úÖ –ò–º—è —Å —Ü–∏—Ñ—Ä–∞–º–∏
- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ
- ‚úÖ –û—Ç–∫–∞–∑ –æ—Ç —Å–æ–≥–ª–∞—Å–∏—è
- ‚úÖ –ù–µ–≤–µ—Ä–Ω—ã–π email
- ‚úÖ –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è

**SubscriptionSchema (3 —Ç–µ—Å—Ç–∞):**

- ‚úÖ –í–∞–ª–∏–¥–Ω—ã–π email
- ‚úÖ –ù–µ–≤–∞–ª–∏–¥–Ω—ã–π email
- ‚úÖ –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π email

**ContactInfoSchema (3 —Ç–µ—Å—Ç–∞):**

- ‚úÖ –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- ‚úÖ –ü—É—Å—Ç—ã–µ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å—Å—ã–ª–∫–∏

**StatsSchema (5 —Ç–µ—Å—Ç–æ–≤):**

- ‚úÖ –í–∞–ª–∏–¥–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- ‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ –ì—Ä–∞–Ω–∏—Ü—ã completion_rate (0-100)
- ‚úÖ –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã)
- ‚úÖ FeedbackResponseSchema

**Response Schemas (7 —Ç–µ—Å—Ç–æ–≤):**

- ‚úÖ FeedbackResponseSchema
- ‚úÖ SubscriptionResponseSchema
- ‚úÖ –í—Å–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç

---

### test_response_validation.py (10 —Ç–µ—Å—Ç–æ–≤)

–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ API:

- ‚úÖ `test_feedback_response_validates_success_field`
- ‚úÖ `test_feedback_response_validates_feedback_id`
- ‚úÖ `test_subscription_response_validates_already_subscribed`
- ‚úÖ `test_contact_info_validates_social_links`
- ‚úÖ `test_stats_validates_numeric_fields`
- ‚úÖ `test_stats_validates_completion_rate_bounds`
- ‚úÖ `test_contact_info_requires_email_and_phone`
- ‚úÖ `test_response_schemas_are_immutable_after_creation`
- ‚úÖ `test_pydantic_models_can_be_serialized_to_dict`
- ‚úÖ `test_pydantic_models_can_be_serialized_to_json`

---

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash

# –í—Å–µ —Ç–µ—Å—Ç—ã core

pytest src/core/tests/ -v

# –¢–æ–ª—å–∫–æ API —Ç–µ—Å—Ç—ã

pytest src/core/tests/test_api.py -v

# –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã —Å—Ö–µ–º

pytest src/core/tests/test_schemas.py -v

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞

pytest src/core/tests/ --cov=core --cov-report=html
```text
---

## üí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–æ–µ–∫—Ç

1. **–î–æ–±–∞–≤–∏—Ç—å –≤ INSTALLED_APPS:**

```python
INSTALLED_APPS = [

    #

    'core',
]
```text
2. **–ü–æ–¥–∫–ª—é—á–∏—Ç—å URL:**

```python
from django.urls import path, include

urlpatterns = [
    path('', include('core.urls')),
]
```text
3. **–î–æ–±–∞–≤–∏—Ç—å context processor:**

```python
TEMPLATES = [
    {
        'OPTIONS': {
            'context_processors': [
                'core.context_processors.footer_data',
            ],
        },
    },
]
```text
4. **–ü–æ–¥–∫–ª—é—á–∏—Ç—å API –∫ –≥–ª–∞–≤–Ω–æ–º—É —Ä–æ—É—Ç–µ—Ä—É:**

```python

# pyland/api.py

from core.api import router as core_router

api = NinjaAPI()
api.add_router("/core/", core_router)
```text
---

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –û—Ç–ø—Ä–∞–≤–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ (AJAX)

```javascript
fetch('/api/core/feedback/', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
        'X-CSRFToken': getCsrfToken()
    },
    body: JSON.stringify({
        first_name: '–ò–≤–∞–Ω',
        phone_number: '+79991234567',
        email: 'ivan@example.com',
        message: '–•–æ—á—É —É–∑–Ω–∞—Ç—å –æ –∫—É—Ä—Å–∞—Ö',
        agree_terms: true
    })
})
.then(response => response.json())
.then(data => {
    console.log('–ó–∞—è–≤–∫–∞ —Å–æ–∑–¥–∞–Ω–∞:', data.feedback_id);
});
```text
---

#### –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ä–∞—Å—Å—ã–ª–∫—É

```javascript
fetch('/api/core/subscribe/', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json'
    },
    body: JSON.stringify({
        email: 'user@example.com'
    })
})
.then(response => response.json())
.then(data => {
    if (data.already_subscribed) {
        alert('–í—ã —É–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã!');
    } else {
        alert(data.message);
    }
});
```text
---

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —à–∞–±–ª–æ–Ω–∞—Ö

```django
{% extends "base.html" %}
{% load markdown_filters %}
{% load article_tags %}

{% block content %}
    <!-- –§—É—Ç–µ—Ä –¥–∞–Ω–Ω—ã–µ (–∏–∑ context processor) -->
    <div class="footer">
        <h3>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –∫—É—Ä—Å—ã</h3>
        {% for course in footer_data.popular_courses %}
            <a href="{{ course.get_absolute_url }}">{{ course.title }}</a>
        {% endfor %}

        <p>–í—Å–µ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤: {{ footer_data.stats.total_students }}</p>
    </div>

    <!-- Markdown –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="article-content">
        {{ content|markdown_format|safe }}
    </div>

    <!-- –°–∫–ª–æ–Ω–µ–Ω–∏–µ —Å–ª–æ–≤–∞ "—Å—Ç–∞—Ç—å—è" -->
    <p>–ù–∞–π–¥–µ–Ω–æ: {{ count }} {{ count|pluralize_articles }}</p>
{% endblock %}
```text
---

---

## ÔøΩ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ logger

–í—Å–µ –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:

```python
import logging

logger = logging.getLogger(__name__)
```text
### –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–í views.py:**

```python
logger.info(f"–§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞: {form.cleaned_data['email']}")
logger.warning("–ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è —Å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º email")
logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ feedback: {str(e)}")
```text
**–í api.py:**

```python
logger.info(f"API: –°–æ–∑–¥–∞–Ω–∞ –∑–∞—è–≤–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ #{feedback.id}")
logger.warning(f"API: –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ –¥–ª—è {email}")
logger.error(f"API: –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: {str(e)}")
```text
**–í forms.py:**

```python
logger.debug(f"–í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞: {phone_number}")
logger.warning(f"–ò–º—è —Å–æ–¥–µ—Ä–∂–∏—Ç —Ü–∏—Ñ—Ä—ã: {first_name}")
```text
### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ settings.py

```python
LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'formatters': {
        'verbose': {
            'format': '{levelname} {asctime} {module} {message}',
            'style': '{',
        },
    },
    'handlers': {
        'file': {
            'level': 'INFO',
            'class': 'logging.FileHandler',
            'filename': 'logs/core.log',
            'formatter': 'verbose',
        },
        'console': {
            'level': 'DEBUG',
            'class': 'logging.StreamHandler',
            'formatter': 'verbose',
        },
    },
    'loggers': {
        'core': {
            'handlers': ['file', 'console'],
            'level': 'INFO',
            'propagate': False,
        },
    },
}
```text
### –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤

```text
INFO 2025-11-10 core.api API: –°–æ–∑–¥–∞–Ω–∞ –∑–∞—è–≤–∫–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ #42
INFO 2025-11-10 core.views –§–æ—Ä–º–∞ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞: ivan@example.com
WARNING 2025-11-10 core.api API: –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ –¥–ª—è test@example.com
ERROR 2025-11-10 core.views –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ feedback: Database error
```text
### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ç–µ—Å—Ç–∞—Ö

–¢–µ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –ª–æ–≥–∏:

```python
import logging

def test_something(caplog):
    with caplog.at_level(logging.INFO):

        # –í—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ

        create_feedback(data)

    # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

    assert "–°–æ–∑–¥–∞–Ω–∞ –∑–∞—è–≤–∫–∞" in caplog.text
```text
---

## ÔøΩ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (cache_utils.py)

### –û–±–∑–æ—Ä

–ú–æ–¥—É–ª—å `cache_utils.py` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Redis, –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `blog.cache_utils`.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

#### get_cache_key(prefix, *args, **kwargs)

–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –∫–µ—à–∞:

```python
from core.cache_utils import get_cache_key

key = get_cache_key('contact_info', user_id=123)

# –†–µ–∑—É–ª—å—Ç–∞—Ç: 'core:contact_info:a1b2c3d4e5f6'

```text
#### cache_page_data(timeout, key_prefix)

–î–µ–∫–æ—Ä–∞—Ç–æ—Ä –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π:

```python
from core.cache_utils import cache_page_data

@cache_page_data(timeout=300, key_prefix='contact_info')
def get_contact_info():

    # –¢—è–∂–µ–ª–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è

    return expensive_data()
```text
#### invalidate_core_cache(patterns)

–ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫–µ—à –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º:

```python
from core.cache_utils import invalidate_core_cache

# –ò–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–µ—à

invalidate_core_cache(['home_page'])

# –ò–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –∫–µ—à core

invalidate_core_cache()
```text
### –ì–æ—Ç–æ–≤—ã–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã

```python
from core.cache_utils import (
    cache_home_page,      # 5 –º–∏–Ω—É—Ç
    cache_contact_info,   # 30 –º–∏–Ω—É—Ç
    cache_about_page,     # 1 —á–∞—Å
    cache_stats,          # 10 –º–∏–Ω—É—Ç
    cache_legal_page,     # 24 —á–∞—Å–∞
)

@cache_home_page()
def get_home_data():
    return {'courses': courses, 'features': features}
```text
### –ü—Ä–æ–≥—Ä–µ–≤ –∫–µ—à–∞

```python
from core.cache_utils import warm_cache

# –ü—Ä–æ–≥—Ä–µ—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

warm_cache()  # –ö–µ—à–∏—Ä—É–µ—Ç —Ç–æ–ø –∫—É—Ä—Å—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
```text
### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ settings.py

```python

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–π–º–∞—É—Ç–æ–≤ –∫–µ—à–∞

CACHE_TTL = {
    'home_page': 300,      # 5 –º–∏–Ω—É—Ç
    'contact_info': 1800,  # 30 –º–∏–Ω—É—Ç
    'about_page': 3600,    # 1 —á–∞—Å
    'stats': 600,          # 10 –º–∏–Ω—É—Ç
    'legal_page': 86400,   # 24 —á–∞—Å–∞
}

# Redis –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

CACHES = {
    'default': {
        'BACKEND': 'django_redis.cache.RedisCache',
        'LOCATION': 'redis://127.0.0.1:6379/1',
        'OPTIONS': {
            'CLIENT_CLASS': 'django_redis.client.DefaultClient',
        }
    }
}
```text
---

## üõ°Ô∏è Middleware (middleware.py)

### CoreRateLimitMiddleware

–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π.

#### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ `settings.py`:

```python
MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',

    # Core middleware

    'core.middleware.CoreRateLimitMiddleware',  # ‚≠ê Rate limiting
    'core.middleware.CoreSecurityHeadersMiddleware',  # ‚≠ê Security headers
]
```text
#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–º–∏—Ç–æ–≤

```python

# –õ–∏–º–∏—Ç—ã –¥–ª—è Core API (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

CORE_API_RATE_LIMITS = {
    'anonymous': {
        'requests': 50,   # 50 –∑–∞–ø—Ä–æ—Å–æ–≤
        'window': 3600    # –≤ —á–∞—Å
    },
    'authenticated': {
        'requests': 200,  # 200 –∑–∞–ø—Ä–æ—Å–æ–≤
        'window': 3600    # –≤ —á–∞—Å
    }
}

# –ü—É—Ç–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

CORE_RATE_LIMIT_PATHS = [
    '/api/core/feedback/',
    '/api/core/subscribe/',
]
```text
#### –û—Ç–≤–µ—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞

```json
HTTP 429 Too Many Requests
{
    "error": "Rate limit exceeded",
    "message": "–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞ —á–µ—Ä–µ–∑ 3456 —Å–µ–∫—É–Ω–¥.",
    "retry_after": 3456,
    "limit": 50,
    "window": 3600
}
```text
#### Headers –æ—Ç–≤–µ—Ç–∞

```text
X-RateLimit-Limit: 50
X-RateLimit-Remaining: 23
X-RateLimit-Reset: 1699876543
```text
### CoreSecurityHeadersMiddleware

–î–æ–±–∞–≤–ª—è–µ—Ç security headers –∫–æ –≤—Å–µ–º –æ—Ç–≤–µ—Ç–∞–º:

```text
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
X-XSS-Protection: 1; mode=block
Referrer-Policy: strict-origin-when-cross-origin
```text
#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

Middleware –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç headers, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ middleware

```python
import logging
logger = logging.getLogger('core.middleware')

# –õ–æ–≥–∏ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞

logger.warning(
    f"Rate limit –ø—Ä–µ–≤—ã—à–µ–Ω –¥–ª—è IP:192.168.1.1 "
    f"–Ω–∞ /api/core/feedback/: 51/50"
)

# –õ–æ–≥–∏ –æ—à–∏–±–æ–∫

logger.error(f"–û—à–∏–±–∫–∞ –≤ CoreRateLimitMiddleware: {e}")
```text
---

## üîÑ –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

### Views (views.py)

–í—Å–µ view —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±–µ—Ä–Ω—É—Ç—ã –≤ try-except –±–ª–æ–∫–∏:

```python
def home(request):
    try:

        # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞

        if request.method == "POST":
            try:
                feedback = Feedback.objects.create(**form.cleaned_data)
                logger.info(f"–§–æ—Ä–º–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞: {email}")
            except Exception as e:
                logger.error(f"–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è feedback: {e}")
                messages.error(request, "–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞...")

        # –ü–æ–ª—É—á–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤

        try:
            courses = Course.objects.annotate(...)[:4]
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤: {e}")
            courses = []

    except Exception as e:
        logger.error(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")
        return render(request, template, fallback_context)
```text
### API (api.py)

–í—Å–µ API endpoints –∑–∞—â–∏—â–µ–Ω—ã:

```python
@router.post("/feedback/")
def create_feedback(request, data: FeedbackSchema):
    try:
        feedback = Feedback.objects.create(...)
        logger.info(f"API: –°–æ–∑–¥–∞–Ω–∞ –∑–∞—è–≤–∫–∞ #{feedback.id}")
        return FeedbackResponseSchema(success=True, ...)
    except Exception as e:
        logger.error(f"API: –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è: {e}")
        return FeedbackResponseSchema(
            success=False,
            message="–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞...",
            feedback_id=None
        )
```text
### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ Graceful degradation - —Å–∞–π—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
‚úÖ Fallback –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ —Å–±–æ—è—Ö –ë–î
‚úÖ –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ blog –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## ÔøΩüìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**Core –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**

- [Templates README](templates/README.md) - HTML —à–∞–±–ª–æ–Ω—ã (5 —Å—Ç—Ä–∞–Ω–∏—Ü)
- [Template Tags README](templatetags/README.md) - Custom tags (2 –º–æ–¥—É–ª—è)
- [Tests README](tests/README.md) - –Æ–Ω–∏—Ç —Ç–µ—Å—Ç—ã (53 —Ç–µ—Å—Ç–∞)

**Static —Ñ–∞–π–ª—ã:**

- [CSS Architecture](../../static/css/core/README.md) - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å—Ç–∏–ª–µ–π
- [JavaScript Documentation](../../static/js/core/README.md) - JS —Å–∫—Ä–∏–ø—Ç—ã

**–î—Ä—É–≥–æ–µ:**

- [Legal Pages README](LEGAL_PAGES_REDESIGN.md) - –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

---

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –≤ `core`:

1. ‚úÖ –î–æ–±–∞–≤—å—Ç–µ docstrings –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º/–∫–ª–∞—Å—Å–∞–º
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ type hints –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
3. ‚úÖ –î–æ–±–∞–≤—å—Ç–µ Pydantic —Å—Ö–µ–º—ã –¥–ª—è API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
4. ‚úÖ –ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã –¥–ª—è –Ω–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
5. ‚úÖ –û–±–µ—Ä–Ω–∏—Ç–µ –∫–æ–¥ –≤ try-except —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
6. ‚úÖ –û–±–Ω–æ–≤–∏—Ç–µ —ç—Ç–æ—Ç README.md

---

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

Pyland Platform ¬© 2025
